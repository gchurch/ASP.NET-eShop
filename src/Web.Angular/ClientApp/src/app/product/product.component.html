<!--Using *ngIf here makes sure that we only subscribe to the observable once-->
<div *ngIf="(product$ | async) as product">

    <button id="editButton" (click)="toggleEdit()" value="Edit">Toggle Edit</button>
    
    <div>
        <div class="column"><img src="assets/{{product.imageUrl}}"/></div>
        <div class="column">

            <div *ngIf="editingProduct && product.id">
                <!--If a valid product is received then display its details.-->
                <form [formGroup]="productForm" (ngSubmit)="onSubmit(product.id)">
                    <p>Title: <input type="text" formControlName="title"/></p>
                    <p>Price: Â£<input type="number" formControlName="price"/></p>
                    <p>Quantity: <input type="number" formControlName="quantity"/></p>
                    <p>Description: <input type="text" formControlName="description"/></p>
                    <p>Seller: <input type="text" formControlName="seller"/></p>
                    <button type="submit" [disabled]="!productForm.valid || productForm.pristine">Update</button>
                </form>
                <button (click)="onDelete(product.id)">Delete</button>
            </div>

            <div *ngIf="!editingProduct && product.id">
                <p id="productTitle">{{product.title}}</p>
                <p id="productPrice">Price: <span>{{product.price | currency}}</span></p>
                <p id="productQuantity">{{product.quantity}} <span>in stock</span></p>
                <p id="productDescription"><span>About this product</span><br>{{product.description}}</p>
                <p id="productSeller">Seller: <span>{{product.seller}}</span></p>
            </div>
        </div>
        <div class="column">
            <button (click)="addToBasket(product)">Add to Basket</button>
        </div>
    </div>
</div>